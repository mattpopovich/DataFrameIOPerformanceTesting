# DataFrame I/O Performance Testing
This repo was created to test the speed of reading and writing DataFrames to/from disk using different file and compression types.

## Target Audience
You have data. You read it, store it, and use it with Python/Pandas `DataFrame`s. You want to know what is the "best" way to do this.

## How This Repo Works
This repo will load data into a Pandas `DataFrame`. It will then write and read the `DataFrame` through all the many options that Python/Pandas provides. Lastly, it will give you a summary of the time it took to write to file, read from file, and the filesize.

You may need to modify the code such that your input file is read in correctly. My sample file, `data.csv` is time series data with the first column specifying the date and time.

## How to Use
Run the following file to perform analysis: `python3 analyze_dataframe_io.py`. A Dockerfile is provided to manage the repo's requirements.

The following arguments are supported:
- `-f` or `--file`
  - Specify the file used for input
- `-k` or `--keep`
  - Do not delete the generated files used for analysis in `/outputs`
- `-v` or `--verbose`
  - For every compression type that supports it, test different levels of compression. Also show some additional columns.

Example output of `analyze_dataframe_io.py` with a 7.4MB `.csv` file:
```
┏━━━━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━┓
┃                ┃ Write  ┃ Read   ┃        ┃         ┃            ┃            ┃          ┃
┃                ┃ time   ┃ time   ┃        ┃ Output  ┃            ┃            ┃ Score    ┃
┃                ┃ to     ┃ from   ┃ Total  ┃ File    ┃            ┃ Output     ┃ (lower   ┃
┃                ┃ file   ┃ file   ┃ I/O    ┃ Size (% ┃ Total I/O  ┃ File Size  ┃ is       ┃
┃ Format         ┃ (s)    ┃ (s)    ┃ (s)    ┃ Orig.)  ┃ Normalized ┃ Normalized ┃ better)  ┃
┡━━━━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━┩
│ pkl.zst        │ 0.0097 │ 0.0058 │ 0.0155 │ 6.26    │ 1.6784     │ 1.6949     │ 3.3733   │
│ parquet.zstd   │ 0.0193 │ 0.0052 │ 0.0245 │ 11.7599 │ 2.6636     │ 3.1841     │ 5.8476   │
│ parquet.lz4    │ 0.0196 │ 0.0046 │ 0.0242 │ 12.3539 │ 2.6322     │ 3.3449     │ 5.9771   │
│ feather        │ 0.0119 │ 0.0043 │ 0.0162 │ 15.8187 │ 1.757      │ 4.283      │ 6.04     │
│ parquet.snappy │ 0.0206 │ 0.0048 │ 0.0254 │ 12.3294 │ 2.7623     │ 3.3383     │ 6.1005   │
│ parquet        │ 0.0205 │ 0.0089 │ 0.0294 │ 15.8355 │ 3.1948     │ 4.2875     │ 7.4823   │
│ pkl.zip        │ 0.0585 │ 0.0143 │ 0.0728 │ 6.2169  │ 7.9045     │ 1.6833     │ 9.5878   │
│ parquet.gzip   │ 0.07   │ 0.0066 │ 0.0766 │ 8.9559  │ 8.3152     │ 2.4248     │ 10.74    │
│ parquet.brotli │ 0.0728 │ 0.0067 │ 0.0795 │ 8.4436  │ 8.6371     │ 2.2862     │ 10.9233  │
│ pkl.gzip       │ 0.0052 │ 0.004  │ 0.0092 │ 50.4742 │ 1          │ 13.6662    │ 14.6662  │
│ pkl            │ 0.0057 │ 0.0042 │ 0.0099 │ 50.4742 │ 1.0763     │ 13.6662    │ 14.7424  │
│ orc            │ 0.0271 │ 0.0087 │ 0.0358 │ 49.0572 │ 3.8895     │ 13.2825    │ 17.172   │
│ h5             │ 0.0379 │ 0.0133 │ 0.0512 │ 74.4187 │ 5.5568     │ 20.1493    │ 25.706   │
│ csv.zst        │ 0.2669 │ 0.0578 │ 0.3247 │ 6.89    │ 35.2697    │ 1.8655     │ 37.1352  │
│ csv.zip        │ 0.3122 │ 0.0673 │ 0.3795 │ 6.5601  │ 41.2176    │ 1.7762     │ 42.9938  │
│ pkl.xz         │ 0.4207 │ 0.0303 │ 0.451  │ 4.892   │ 48.9834    │ 1.3245     │ 50.3079  │
│ csv            │ 0.2945 │ 0.0567 │ 0.3512 │ 69.7714 │ 38.1486    │ 18.891     │ 57.0396  │
│ csv.gz         │ 0.4481 │ 0.0659 │ 0.514  │ 5.9552  │ 55.8214    │ 1.6124     │ 57.4338  │
│ pkl.bz2        │ 0.5393 │ 0.0507 │ 0.5901 │ 7.5608  │ 64.0879    │ 2.0471     │ 66.135   │
│ csv.bz2        │ 0.5604 │ 0.1107 │ 0.6711 │ 5.0619  │ 72.8861    │ 1.3705     │ 74.2567  │
│ csv.xz         │ 1.9976 │ 0.0844 │ 2.082  │ 3.6934  │ 226.1286   │ 1          │ 227.1286 │
└────────────────┴────────┴────────┴────────┴─────────┴────────────┴────────────┴──────────┘
```

<details>
  <summary>Click to show the `--verbose` output for that file:</summary>

```
┏━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━┓
┃                ┃            ┃ Write  ┃ Read   ┃        ┃         ┃            ┃            ┃            ┃          ┃
┃                ┃ DataFrame  ┃ time   ┃ time   ┃        ┃ Output  ┃            ┃            ┃            ┃ Score    ┃
┃                ┃ Memory     ┃ to     ┃ from   ┃ Total  ┃ File    ┃            ┃            ┃ Output     ┃ (lower   ┃
┃                ┃ Difference ┃ file   ┃ file   ┃ I/O    ┃ Size (% ┃ Equivalent ┃ Total I/O  ┃ File Size  ┃ is       ┃
┃ Format         ┃ (B)        ┃ (s)    ┃ (s)    ┃ (s)    ┃ Orig.)  ┃ DataFrames ┃ Normalized ┃ Normalized ┃ better)  ┃
┡━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━┩
│ pkl.zst C=3    │ 0          │ 0.0098 │ 0.0055 │ 0.0153 │ 6.26    │ True       │ 1.6436     │ 1.6949     │ 3.3385   │
│ pkl.zst C=0    │ 0          │ 0.0097 │ 0.0057 │ 0.0154 │ 6.26    │ True       │ 1.6549     │ 1.6949     │ 3.3498   │
│ pkl.zst        │ 0          │ 0.0098 │ 0.0057 │ 0.0156 │ 6.26    │ True       │ 1.6763     │ 1.6949     │ 3.3712   │
│ pkl.zst C=4    │ 0          │ 0.0104 │ 0.0057 │ 0.016  │ 6.2634  │ True       │ 1.7238     │ 1.6959     │ 3.4197   │
│ pkl.zst C=1    │ 0          │ 0.0095 │ 0.0057 │ 0.0152 │ 7.2059  │ True       │ 1.6343     │ 1.951      │ 3.5853   │
│ pkl.zst C=2    │ 0          │ 0.0092 │ 0.0061 │ 0.0153 │ 7.3869  │ True       │ 1.6411     │ 2          │ 3.6412   │
│ pkl.zst C=-2   │ 0          │ 0.0078 │ 0.0049 │ 0.0127 │ 8.4334  │ True       │ 1.3642     │ 2.2834     │ 3.6476   │
│ pkl.zst C=-1   │ 0          │ 0.008  │ 0.0053 │ 0.0133 │ 8.4571  │ True       │ 1.4358     │ 2.2898     │ 3.7256   │
│ pkl.zst C=5    │ 0          │ 0.0174 │ 0.0051 │ 0.0226 │ 6.1122  │ True       │ 2.4271     │ 1.6549     │ 4.082    │
│ pkl.zst C=-4   │ 0          │ 0.0071 │ 0.0051 │ 0.0122 │ 10.4564 │ True       │ 1.317      │ 2.8311     │ 4.1481   │
│ pkl.zst C=-3   │ 0          │ 0.0079 │ 0.0049 │ 0.0128 │ 10.47   │ True       │ 1.3782     │ 2.8348     │ 4.213    │
│ pkl.zst C=6    │ 0          │ 0.0205 │ 0.005  │ 0.0256 │ 6.0101  │ True       │ 2.7527     │ 1.6273     │ 4.38     │
│ pkl.zst C=7    │ 0          │ 0.0226 │ 0.0049 │ 0.0274 │ 5.9834  │ True       │ 2.9535     │ 1.62       │ 4.5735   │
│ pkl.zst C=-5   │ 0          │ 0.0078 │ 0.0048 │ 0.0126 │ 12.0002 │ True       │ 1.3521     │ 3.2491     │ 4.6012   │
│ pkl.zst C=-6   │ 0          │ 0.0078 │ 0.005  │ 0.0129 │ 12.6744 │ True       │ 1.3841     │ 3.4317     │ 4.8157   │
│ pkl.zst C=8    │ 0          │ 0.0271 │ 0.005  │ 0.0321 │ 5.9119  │ True       │ 3.4576     │ 1.6007     │ 5.0583   │
│ pkl.zst C=9    │ 0          │ 0.0272 │ 0.005  │ 0.0322 │ 5.9113  │ True       │ 3.4677     │ 1.6005     │ 5.0682   │
│ pkl.zst C=-7   │ 0          │ 0.0081 │ 0.0058 │ 0.0139 │ 13.9512 │ True       │ 1.4953     │ 3.7774     │ 5.2727   │
│ pkl.gzip C=1   │ 0          │ 0.0213 │ 0.011  │ 0.0323 │ 7.0612  │ True       │ 3.4718     │ 1.9119     │ 5.3837   │
│ pkl.gzip C=2   │ 0          │ 0.023  │ 0.0122 │ 0.0352 │ 6.8926  │ True       │ 3.7885     │ 1.8662     │ 5.6547   │
│ pkl.zip C=1    │ 0          │ 0.0223 │ 0.0133 │ 0.0357 │ 7.0624  │ True       │ 3.8383     │ 1.9122     │ 5.7504   │
│ parquet.zstd   │ 0          │ 0.0197 │ 0.0044 │ 0.0241 │ 11.7599 │ True       │ 2.5896     │ 3.1841     │ 5.7736   │
│ pkl.gzip C=3   │ 0          │ 0.026  │ 0.0108 │ 0.0368 │ 6.7933  │ True       │ 3.9583     │ 1.8393     │ 5.7976   │
│ pkl.zip C=2    │ 0          │ 0.0236 │ 0.0132 │ 0.0368 │ 6.8938  │ True       │ 3.9586     │ 1.8665     │ 5.8251   │
│ parquet.lz4    │ 0          │ 0.0196 │ 0.0046 │ 0.0242 │ 12.3539 │ True       │ 2.6032     │ 3.3449     │ 5.9481   │
│ parquet.snappy │ 0          │ 0.0196 │ 0.0048 │ 0.0244 │ 12.3294 │ True       │ 2.6213     │ 3.3383     │ 5.9595   │
│ feather        │ 0          │ 0.0114 │ 0.0049 │ 0.0162 │ 15.8187 │ True       │ 1.7479     │ 4.283      │ 6.0309   │
│ pkl.zip C=3    │ 0          │ 0.0262 │ 0.0129 │ 0.0391 │ 6.7945  │ True       │ 4.2068     │ 1.8396     │ 6.0464   │
│ pkl.gzip C=4   │ 0          │ 0.0289 │ 0.0116 │ 0.0404 │ 6.5232  │ True       │ 4.3524     │ 1.7662     │ 6.1185   │
│ pkl.zip C=4    │ 0          │ 0.0287 │ 0.0129 │ 0.0415 │ 6.5244  │ True       │ 4.4688     │ 1.7665     │ 6.2354   │
│ pkl.gzip C=5   │ 0          │ 0.0347 │ 0.0109 │ 0.0457 │ 6.3384  │ True       │ 4.9143     │ 1.7162     │ 6.6304   │
│ pkl.zst C=10   │ 0          │ 0.0421 │ 0.005  │ 0.0471 │ 5.8909  │ True       │ 5.0665     │ 1.595      │ 6.6615   │
│ pkl.zip C=5    │ 0          │ 0.0344 │ 0.0129 │ 0.0473 │ 6.3396  │ True       │ 5.0895     │ 1.7165     │ 6.806    │
│ parquet        │ 0          │ 0.0193 │ 0.0087 │ 0.028  │ 15.8355 │ True       │ 3.0158     │ 4.2875     │ 7.3034   │
│ pkl.zst C=13   │ 0          │ 0.0638 │ 0.0049 │ 0.0687 │ 5.8931  │ True       │ 7.3939     │ 1.5956     │ 8.9895   │
│ pkl.gzip C=6   │ 0          │ 0.0582 │ 0.0108 │ 0.0689 │ 6.2158  │ True       │ 7.415      │ 1.683      │ 9.098    │
│ pkl.gzip C=-1  │ 0          │ 0.0582 │ 0.0109 │ 0.0691 │ 6.2158  │ True       │ 7.4333     │ 1.683      │ 9.1162   │
│ pkl.zst C=11   │ 0          │ 0.0652 │ 0.0049 │ 0.0702 │ 5.8769  │ True       │ 7.5529     │ 1.5912     │ 9.1441   │
│ pkl.zip        │ 0          │ 0.0588 │ 0.0126 │ 0.0714 │ 6.2169  │ True       │ 7.6846     │ 1.6833     │ 9.3678   │
│ pkl.zip C=6    │ 0          │ 0.0593 │ 0.0126 │ 0.0719 │ 6.217   │ True       │ 7.7366     │ 1.6833     │ 9.4199   │
│ pkl.zst C=12   │ 0          │ 0.068  │ 0.0052 │ 0.0732 │ 5.8768  │ True       │ 7.8775     │ 1.5912     │ 9.4687   │
│ pkl.zip C=0    │ 0          │ 0.0592 │ 0.0137 │ 0.0729 │ 6.217   │ True       │ 7.8415     │ 1.6833     │ 9.5247   │
│ parquet.gzip   │ 0          │ 0.0662 │ 0.0065 │ 0.0728 │ 8.9559  │ True       │ 7.8282     │ 2.4248     │ 10.253   │
│ pkl.zst C=14   │ 0          │ 0.0805 │ 0.0054 │ 0.0859 │ 5.8724  │ True       │ 9.2458     │ 1.59       │ 10.8358  │
│ parquet.brotli │ 0          │ 0.0733 │ 0.0068 │ 0.0801 │ 8.4436  │ True       │ 8.6205     │ 2.2862     │ 10.9066  │
│ pkl.gzip C=7   │ 0          │ 0.0827 │ 0.0108 │ 0.0935 │ 6.248   │ True       │ 10.0557    │ 1.6917     │ 11.7473  │
│ pkl.xz C=1     │ 0          │ 0.0678 │ 0.0294 │ 0.0972 │ 5.0277  │ True       │ 10.4582    │ 1.3613     │ 11.8195  │
│ pkl.zip C=7    │ 0          │ 0.0824 │ 0.0131 │ 0.0955 │ 6.2491  │ True       │ 10.2733    │ 1.692      │ 11.9653  │
│ pkl.xz C=2     │ 0          │ 0.0784 │ 0.029  │ 0.1073 │ 5.0048  │ True       │ 11.5494    │ 1.3551     │ 12.9045  │
│ pkl.zst C=15   │ 0          │ 0.1048 │ 0.0052 │ 0.11   │ 5.8644  │ True       │ 11.8326    │ 1.5878     │ 13.4204  │
│ pkl.xz C=3     │ 0          │ 0.0892 │ 0.029  │ 0.1182 │ 4.9951  │ True       │ 12.7177    │ 1.3525     │ 14.0702  │
│ pkl            │ 0          │ 0.0057 │ 0.0036 │ 0.0093 │ 50.4742 │ True       │ 1          │ 13.6662    │ 14.6662  │
│ pkl.gzip C=0   │ 0          │ 0.0058 │ 0.0038 │ 0.0096 │ 50.4742 │ True       │ 1.0313     │ 13.6662    │ 14.6974  │
│ pkl.gzip       │ 0          │ 0.0062 │ 0.0037 │ 0.01   │ 50.4742 │ True       │ 1.0731     │ 13.6662    │ 14.7392  │
│ orc            │ 0          │ 0.0257 │ 0.0085 │ 0.0341 │ 49.0572 │ True       │ 3.6741     │ 13.2825    │ 16.9566  │
│ pkl.zst C=16   │ 0          │ 0.1615 │ 0.0049 │ 0.1664 │ 5.7376  │ True       │ 17.9097    │ 1.5535     │ 19.4632  │
│ pkl.zst C=17   │ 0          │ 0.1848 │ 0.005  │ 0.1897 │ 5.5962  │ True       │ 20.4153    │ 1.5152     │ 21.9305  │
│ pkl.gzip C=8   │ 0          │ 0.1902 │ 0.0108 │ 0.201  │ 6.2712  │ True       │ 21.6281    │ 1.698      │ 23.326   │
│ pkl.zip C=8    │ 0          │ 0.1919 │ 0.0131 │ 0.205  │ 6.2724  │ True       │ 22.0556    │ 1.6983     │ 23.7539  │
│ pkl.xz C=4     │ 0          │ 0.1889 │ 0.0301 │ 0.2189 │ 5.0341  │ True       │ 23.5582    │ 1.363      │ 24.9212  │
│ h5             │ 709932     │ 0.0341 │ 0.0127 │ 0.0469 │ 74.4187 │ True       │ 5.0412     │ 20.1493    │ 25.1905  │
│ pkl.zst C=18   │ 0          │ 0.2301 │ 0.005  │ 0.2352 │ 5.5585  │ True       │ 25.304     │ 1.505      │ 26.809   │
│ pkl.xz C=5     │ 0          │ 0.2691 │ 0.03   │ 0.2992 │ 4.9493  │ True       │ 32.1888    │ 1.34       │ 33.5288  │
│ csv.zst        │ 0          │ 0.2666 │ 0.0585 │ 0.3251 │ 6.89    │ True       │ 34.9815    │ 1.8655     │ 36.847   │
│ csv.zip        │ 0          │ 0.3129 │ 0.067  │ 0.3799 │ 6.5601  │ True       │ 40.8733    │ 1.7762     │ 42.6495  │
│ pkl.gzip C=9   │ 0          │ 0.3863 │ 0.0108 │ 0.397  │ 6.2702  │ True       │ 42.7206    │ 1.6977     │ 44.4183  │
│ pkl.zip C=9    │ 0          │ 0.3902 │ 0.0135 │ 0.4037 │ 6.2714  │ True       │ 43.4341    │ 1.698      │ 45.1322  │
│ pkl.xz         │ 0          │ 0.3882 │ 0.0301 │ 0.4183 │ 4.892   │ True       │ 45.0088    │ 1.3245     │ 46.3334  │
│ pkl.xz C=6     │ 0          │ 0.3911 │ 0.0317 │ 0.4228 │ 4.892   │ True       │ 45.4897    │ 1.3245     │ 46.8142  │
│ pkl.xz C=0     │ 0          │ 0.395  │ 0.0297 │ 0.4248 │ 4.892   │ True       │ 45.7041    │ 1.3245     │ 47.0287  │
│ pkl.xz C=7     │ 0          │ 0.3986 │ 0.03   │ 0.4286 │ 4.892   │ True       │ 46.1139    │ 1.3245     │ 47.4385  │
│ pkl.xz C=9     │ 0          │ 0.4074 │ 0.03   │ 0.4373 │ 4.892   │ True       │ 47.0561    │ 1.3245     │ 48.3806  │
│ pkl.xz C=8     │ 0          │ 0.4083 │ 0.03   │ 0.4383 │ 4.892   │ True       │ 47.1645    │ 1.3245     │ 48.4891  │
│ pkl.zst C=19   │ 0          │ 0.4419 │ 0.005  │ 0.4469 │ 5.5052  │ True       │ 48.0846    │ 1.4906     │ 49.5751  │
│ pkl.bz2 C=2    │ 0          │ 0.3944 │ 0.0479 │ 0.4423 │ 7.3712  │ True       │ 47.5927    │ 1.9958     │ 49.5885  │
│ pkl.zst C=20   │ 0          │ 0.4565 │ 0.0051 │ 0.4616 │ 5.5052  │ True       │ 49.6646    │ 1.4906     │ 51.1551  │
│ pkl.bz2 C=1    │ 0          │ 0.4111 │ 0.0464 │ 0.4575 │ 7.305   │ True       │ 49.2241    │ 1.9779     │ 51.202   │
│ pkl.bz2 C=3    │ 0          │ 0.41   │ 0.0499 │ 0.4599 │ 7.4137  │ True       │ 49.4868    │ 2.0073     │ 51.4941  │
│ pkl.bz2 C=5    │ 0          │ 0.4288 │ 0.0487 │ 0.4775 │ 7.5201  │ True       │ 51.3783    │ 2.0361     │ 53.4144  │
│ pkl.bz2 C=4    │ 0          │ 0.4424 │ 0.0493 │ 0.4917 │ 7.433   │ True       │ 52.9045    │ 2.0125     │ 54.917   │
│ pkl.bz2 C=6    │ 0          │ 0.462  │ 0.0483 │ 0.5104 │ 7.5481  │ True       │ 54.916     │ 2.0437     │ 56.9597  │
│ csv.gz         │ 0          │ 0.4504 │ 0.0654 │ 0.5159 │ 5.9552  │ True       │ 55.5071    │ 1.6124     │ 57.1196  │
│ csv            │ 0          │ 0.3012 │ 0.0581 │ 0.3593 │ 69.7714 │ True       │ 38.6647    │ 18.891     │ 57.5557  │
│ pkl.bz2 C=8    │ 0          │ 0.4932 │ 0.0495 │ 0.5428 │ 7.5395  │ True       │ 58.4008    │ 2.0414     │ 60.4421  │
│ pkl.zst C=21   │ 0          │ 0.5603 │ 0.0052 │ 0.5655 │ 5.5021  │ True       │ 60.8455    │ 1.4897     │ 62.3353  │
│ pkl.bz2 C=7    │ 0          │ 0.5178 │ 0.0483 │ 0.5661 │ 7.5493  │ True       │ 60.9083    │ 2.044      │ 62.9523  │
│ pkl.bz2 C=9    │ 0          │ 0.5303 │ 0.0491 │ 0.5795 │ 7.5608  │ True       │ 62.3505    │ 2.0471     │ 64.3976  │
│ pkl.bz2        │ 0          │ 0.5333 │ 0.0488 │ 0.5821 │ 7.5608  │ True       │ 62.6384    │ 2.0471     │ 64.6856  │
│ csv.bz2        │ 0          │ 0.5362 │ 0.1081 │ 0.6443 │ 5.0619  │ True       │ 69.3253    │ 1.3705     │ 70.6958  │
│ pkl.zst C=22   │ 0          │ 0.7124 │ 0.0052 │ 0.7176 │ 5.5004  │ True       │ 77.2137    │ 1.4893     │ 78.703   │
│ csv.xz         │ 0          │ 1.9274 │ 0.0831 │ 2.0104 │ 3.6934  │ True       │ 216.3191   │ 1          │ 217.3191 │
└────────────────┴────────────┴────────┴────────┴────────┴─────────┴────────────┴────────────┴────────────┴──────────┘
```

</details>
